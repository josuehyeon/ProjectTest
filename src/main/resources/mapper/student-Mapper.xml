<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 모든 SQL문을 mapper태그 안에 작성 -->
<mapper namespace="studentMapper">

	<resultMap type="com.kh.project.stuInfo.vo.StudentVO" id="student">
		<id 	column="STU_NO" 	property="stuNo" />
		<result column="STU_NAME" 	property="stuName" />
		<result column="COLL_NO" 	property="collNo" />
		<result column="MAJOR_CODE" property="majorCode" />
		<result column="MINOR_CODE" property="minorCode" />
		<result column="STU_YEAR" 	property="stuYear" />
		<result column="STU_SEM" 	property="stuSem" />
		<result column="STU_STATUS" property="stuStatus" />
		<result column="MAJOR_NAME" property="majorName" />
		<result column="MINOR_NAME" property="minorName" />
		<association property="memberInfo" resultMap="memberMapper.member"/>
		<association property="collegeInfo" resultMap="collegeMapper.college"/>
		<association property="deptInfo" resultMap="deptMapper.dept"/>
	</resultMap>
	
	<select id="selectStuMyInfo" resultMap="student">
		SELECT   STU_NO
			  , (SELECT COLL_NAME FROM COLLEGE WHERE COLL_NO = S.COLL_NO) AS COLL_NAME
			  , (SELECT DEPT_NAME FROM DEPT WHERE DEPT_ID= S.MAJOR_CODE) AS MAJOR_CODE
              , (SELECT DEPT_NAME FROM DEPT WHERE DEPT_ID = S.MINOR_CODE) AS MINOR_CODE
			  ,  STU_YEAR
			  ,  STU_SEM 
			  ,  STU_STATUS             
		FROM     STUDENT S , COLLEGE C , DEPT D
		WHERE    S.COLL_NO = C.COLL_NO
		AND      S.MAJOR_CODE = D.DEPT_ID
		AND      STU_NO = #{stuNo}
	</select>
	
	<select id="goStopStudy" resultMap="student">
		SELECT M.MEM_NAME
			, C.COLL_NAME
			, STU_YEAR
			, D.DEPT_NAME
			, S.MINOR_CODE
			, M.MEM_BIRTH
			, S.STU_STATUS
			, S.STU_NO			
		FROM STUDENT S , MEMBER M, COLLEGE C, DEPT D
		WHERE S.MEM_NO = M.MEM_NO
		AND S.COLL_NO = C.COLL_NO
		AND S.MAJOR_CODE = D.DEPT_ID
		AND M.MEM_NO = #{memNo}
	</select>
	
	
	<select id="selectMyInfoForGraduation" resultMap="student">
		SELECT  S.STU_NO
			  , M.MEM_NAME
			  , S.STU_YEAR
			  , S.COLL_NO
			  , S.MAJOR_CODE
			  , S.MINOR_CODE
		FROM  MEMBER M,  STUDENT S
		WHERE M.MEM_NO = S.STU_NO
		AND   S.STU_NO = #{memNo} 
	</select>

	

</mapper>












